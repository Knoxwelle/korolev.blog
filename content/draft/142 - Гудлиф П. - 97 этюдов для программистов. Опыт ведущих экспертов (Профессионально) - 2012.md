+++
title='142 - Гудлиф П. - 97 этюдов для программистов. Опыт ведущих экспертов (Профессионально) - 2012'
date=2024-07-10T00:00:00-07:00
draft=true
categories=[]
tags=[]
cover_image='/images/cover/knoxwelle__2021-08-08T051054.000Z.jpg'
+++
Стив Фримен
Мне при­хо­ди­лось встре­чать про­ек­ты, где при сборке переписывалась часть кода, чтобы для каждой среды исполнения генерировался собственный бинарный 
файл. Такой подход всегда излишне усложняет вещи и создает риск появления 
несовместимых версий при каждой установке. Как минимум при этом собирается несколько почти идентичных экземпляров программы, каждый из которых 
предназначен для установки в соответствующей ему среде. Возникает слишком 
много подвижных частей, а значит, больше возможностей для ошибки.
Однажды я работал в команде, где после каждого изменения свойства нужно было сохранять код и проводить полный цикл сборки, поэтому тестировщики простаивали всякий раз, как находилась малейшая неточность (я уже говорил, что 
к тому же проект собирался невероятно долго?). Работал я и в такой команде, где 
системные администраторы требовали полной пересборки программы при вводе 
ее в эксплуатацию (с помощью наших же сценариев сборки), так что невозможно 
было гарантировать, что в эксплуатацию попадала та версия, которая прошла 
тестирование. И так далее.
Правило простое: создавать единственный бинарный файл, который можно
точно идентифицировать и провести через все этапы конвейера выпуска продукта. Все специфические особенности среды исполнения должны оставаться 
частью среды. Например, их можно хранить в контейнере с компонентами (component container), в заранее согласованном файле или в определенных папках.
Если во время сборки вашего проекта производятся манипуляции с кодом или 
настройки целевой среды хранятся в самом коде, значит, приложение было 
спроектировано недостаточно хорошо: ключевые функции приложения не отделены от функций, определяемых платформой. Или еще хуже: команда знает, 
как нужно поступить, но не считает внесение нужных изменений достаточно 
приоритетной задачей.
Бывают, конечно, исключения: иногда приходится делать сборку для нескольких вариантов целевой среды, в которых ограничения по ресурсам существенно 
Один бинарный файлОдин бинарный файл 143
разнятся. Однако это не относится к тем из нас (и таких большинство), кто создает приложения типа «отправить данные из базы данных на экран и обратно». 
Другой вариант – работа с плохо написанным унаследованным (legacy) кодом, 
в котором навести порядок сразу слишком тяжело. В таких случаях следует двигаться постепенно, но начинайте это движение как можно раньше.
И еще одно: храните информацию о среде выполнения в системе управления версиями, как и код. Нет ничего хуже, чем испортить конфигурацию среды и не 
иметь возможности узнать, какие в нее были внесены изменения. Настройки 
среды должны храниться в отдельном репозитории, так как они меняются с другой скоростью и по другим причинам, чем код. Некоторые команды используют 
для этого распределенные системы управления версиями (например, bazaar
и git), поскольку в них проще сохранять в репозиторий изменения, сделанные 
в производственной (production) среде – а они неизбежно случаются.