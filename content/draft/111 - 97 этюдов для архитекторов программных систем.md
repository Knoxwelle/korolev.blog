+++
title='Не контролируйте – наблюдайте'
date=2024-07-10T00:00:00-07:00
draft=true
categories=[]
tags=[]
cover_image='/images/cover/knoxwelle__2021-08-08T051054.000Z.jpg'
+++
Не контролируйте – 
наблюдайте
Грегор Хоп
Современные системы являются распределенными и слабо связанными 
(loosely coupled). Построение слабо связанных систем создает немало хлопот, так почему же мы идем на это? Потому что хотим, чтобы наши системы
были гибкими и не разваливались при малейших изменениях. Это критическое свойство в современных средах, где мы контролируем лишь небольшую
часть своего приложения, а все остальное существует в виде распределенных служб или пакетов, находящихся под контролем других отделов или
внешних производителей.
Итак, стремление создать систему гибкую и способную развиваться со временем – дело хорошее. Но это означает также, что наша система будет постепенно изменяться. Другими словами, «сегодня система уже не та, какой была вчера».К сожалению, это заметно усложняет документирование системы.
Все знают, что документация устаревает в момент печати, но в постоянно изменяющейся системе дела могут обстоять еще хуже. Более того, построение
гибкой системы обычно усложняет архитектуру, и получить пресловутую
«общую картину» становится еще труднее. Например, если все компоненты
системы обмениваются информацией по логическим, настраиваемым каналам, то, чтобы получить представление о происходящем, необходимо взглянуть на конфигурацию каналов. Отправка сообщений в логическое пойдитуда-не-знаю-куда вряд ли приведет к ошибке компиляции, но наверняка
огорчит пользователя, действие которого было запаковано в это сообщение.
Архитектор, помешанный на тотальном контроле, – фигура из прошлого;
решения, которые он создает, являются сильно связанными и хрупкими.
С другой стороны, полная и неограниченная свобода приложения – верный
путь к хаосу. Ослабление контроля необходимо дополнить другими механизмами, чтобы «полет по приборам» не происходил без самих приборов. Но
какие приборы есть в нашем распоряжении? Вообще-то их более чем достаточно. Современные языки программирования поддерживают рефлексию
(reflection), и почти все платформы предоставляют динамические метрики
времени выполнения. По мере того как система становится более настраиваемой, ее текущая конфигурация сама становится отличным источником
информации. Так как разобраться в слишком большом объеме низкоуровневых данных довольно трудно, создайте на их основе модель. Например, когда станет ясно, какие компоненты отправляют сообщения по тем или иным
логическим каналам и какие компоненты ожидают поступления сообщений
по этим каналам, вы сможете построить граф передачи данных между компонентами. Эту процедуру можно производить каждые несколько минут
или часов, создавая точную и оперативную картину системы в ходе ее развития. Считайте это своего рода «MDA наоборот»1: вместо модели, управляющей архитектурой, вы строите гибкую архитектуру и формируете модель на
основании текущего состояния системы.
Во многих случаях модель можно легко визуализировать, построив действительно «общую картину». Однако боритесь с соблазном заполнить квадратиками и линиями полотно 3×5 метров в стремлении изобразить все классы
вашей системы. Такая картина сойдет за произведение современного искусства, но ее не назовешь полезной программной моделью. Вместо этого лучше использовать «вид с высоты 300 метров», как рекомендует Эрик Дорненбург, – тот уровень абстракции, который содержит действительно полезную
информацию. Вдобавок вы сможете проследить за тем, чтобы в модели не
было нарушений простейших правил корректности – циклических ссылок
в графе зависимостей или отправки сообщений по непрослушиваемым логическим каналам.
Ослабление контроля пугает, особенно когда речь идет об архитектуре системы. Но в сочетании с тщательным наблюдением, построением моделей и проверкой корректности оно, вероятно, является единственным разумным подходом к построению архитектуры программного обеспечения в XXI веке.