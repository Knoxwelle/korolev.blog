+++
title='Пит Гудлиф'
date=2024-07-10T00:00:00-07:00
draft=true
categories=[]
tags=[]
cover_image='/images/cover/knoxwelle__2021-08-08T051054.000Z.jpg'
+++
Пит Гудлиф
Как-то вечером я шел по улице на встречу с друзьями в баре. Мы давненько не
пили вместе пиво, я спешил и думал только о встрече с ними. Поэтому я плохо смотрел себе под ноги. Споткнувшись о край тротуара, я упал плашмя, но
решил не обращать на это внимания.
Нога болела, но я же спешил на встречу с друзьями! Я собрался с силами и двинулся дальше. По ходу дела боль усиливалась. Поначалу я думал, что просто
проходит болевой шок, но вскоре понял, что дело серьезнее.
И все же я направился в сторону бара. Когда я добрался туда, мне было уже
невыносимо больно. Вечер не особенно удался – боль не давала о себе забыть.
Утром я пошел к доктору, и выяснилось, что у меня сломана голень. Остановись я, когда стало больно, мне удалось бы избежать многих осложнений, вызванных тем, что я продолжал идти дальше. Предположу, то было мое худшее в жизни утреннее похмелье.
Слиш­ком мно­гие про­грам­ми­сты пишут код в духе моего поведения в тот вечер.
Ошибка? Какая еще ошибка? Это просто ерунда. Честно. Можно не обращать
на нее внимания. Для создания надежного кода такая стратегия не годится. 
Скажу больше, это попросту лень. (Вредная ее разновидность.) Что бы вы там себе ни воображали по поводу отсутствия ошибок в собственном коде, их всегда 
нужно проверять и всегда обрабатывать. Обязательно. Поступая иначе, вы не 
экономите время, но запасаетесь потенциальными проблемами на будущее.
Сообщить об ошибке в коде можно разными способами, например:
• Вернуть в результате работы функции код ошиб­ки, который означает, что 
функция отработала неверно. Код ошибки очень легко игнорировать. В коде 
ничто не укажет на проблему. Вообще теперь стало принято игнорировать 
значения, возвращаемые некоторыми стандартными функциями C. Часто ли 
вы проверяете значение, возвращаемое функцией printf?
• errno – любопытный маразм языка C, специальная глобальная переменная, которая должна сигнализировать об ошибке. Ее легко игнорировать, ее неудобно 
применять и она служит источником всяческих неприятностей: что, наприНе проходите мимо ошибки!Не проходите мимо ошибки! 73
мер, делать, если в программе несколько потоков, вызывающих одну и ту же 
функцию? Одни платформы помогают избежать проблем в таких ситуациях, 
другие – нет.
• Ис­клю­че­ния – это более организованный способ уведомлять об ошибках и обрабатывать их, причем способ, встроенный в язык. Игнорировать исключения невозможно. Или все же можно? Мне часто встречался код типа
try {
 // ...что-то выполнить...
}
catch (...) {} // игнорировать ошибки
Единственное достоинство этой ужасной конструкции – подчеркнуть, что в коде происходит нечто сомнительное с точки зрения морали. 
Игнорируя ошибку, закрывая глаза и делая вид, что ничего не произошло, вы 
подвергаетесь большому риску. Как моя нога сильнее пострадала потому, что 
я не остановился немедленно, так и движение напролом через красные флажки 
может привести к очень серьезным проблемам. Проблемы нужно решать при 
первой же возможности. Не затягивайте выплату долгов.
Если не обрабатывать ошибки, вот что вы получите:
• Не­ста­биль­ный код. Код со множеством восхитительных и трудных для обнаружения ошибок.
• Не­без­опас­ный код. Взломщики часто пользуются недостатками обработки 
ошибок для взлома программных систем.
• Пло­хая струк­ту­ра. Если в вашем коде постоянно проявляются ошибки, которые трудно обрабатывать, то, вероятно, у вас неудачный интерфейс. Формулируйте его таким образом, чтобы ошибки становились менее назойливыми, 
а их обработка не была столь обременительна.
Следует не только проверять все возможные ошибки в коде, но и обнажать все 
потенциально ошибочные состояния в интерфейсах. Не скрывайте их – нет 
смысла притворяться, что ваши службы всегда будут работоспособны.
Почему мы не выполняем проверку на ошибки? Вот некоторые стандартные 
оправдания: 
• Обработка ошибок загромождает код, затрудняя его чтение и отслеживание 
«нормального» потока выполнения.
• Это лишняя работа, а на меня давят сроки сдачи.
• Я уверен, что эта функция никогда не вернет ошибку (printf всегда работает, 
malloc всегда выделяет память, а если нет, наши проблемы гораздо серьезнее…)
• Это прототип, нет смысла делать его пригодным для коммерческого применения.
С какими из них вы согласны? Что вы могли бы на них возразить?